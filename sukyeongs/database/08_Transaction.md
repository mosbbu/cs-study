## 🔄 트랜잭션(Transaction)

**트랜잭션(Transaction)** : 데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 or 한꺼번에 모두 수행되어야 할 일련의 연산들을 의미한다.

- 데이터베이스의 상태를 변환시킨다 = SQL 질의어를 통해 DB에 접근한다

> **[SQL 질의어]**
>
> - SELECT : 데이터 조회
> - INSERT :
> - DELETE
> - UPDATE

<br>

### 트랜잭션의 특징

1. 트랜잭션은 데이터베이스 시스템에서 **병행 제어** 및 **회복 작업** 시 처리되는 **작업의 논리적 단위**이다.

> **병행(Concurrency)** : 매우 빠르게 여러 트랜잭션 사이를 이동하면서 조금씩 처리를 수행하는 방식
>
> **병행 제어(Concurrency Control)** : 트랜잭션이 병행 수행될 때 트랜잭션이 데이터베이스의 일관성을 파괴하지 않고, 다른 트랜잭션에 영향을 주지 않도록 **트랜잭션 간의 상호작용을 제어**하는 것

2. 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 **상태 변환 과정의 작업단위**이다.

3. 하나의 트랜잭션은 `Commit` 되거나 `Rollback` 된다.

<br>

### 트랜잭션의 성질(ACID)

#### 1. Atomicity(원자성)

- 트랜잭션의 연산은 데이터베이스에 **모두 반영**되거나 **전혀 반영되지 않아**야 한다.
- 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.

#### 2. Consistency(일관성)

- 트랜잭션이 그 실행을 성공적으로 완료하면 언제든 **일관성 있는 데이터베이스 상태**로 변환한다.
- 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 수행 완료 후의 상태가 같아야 한다.

#### 3. Isolation(독립성)

- 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우, 어느 하나의 트랜잭션이 실행 중이라면 **다른 트랜잭션의 연산이 끼어들 수 없다**.
- 수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.

#### 4. Durability(영속성)

- 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.

<br>

### 트랜잭션 연산

#### 1. `Commit` 연산

- 한 개의 논리적 단위(트랜잭션)에 대한 작업이 **성공적으로 끝났고** 데이터베이스가 다시 일관된 상태에 있을 때, 이 트랜잭션이 행한 **갱신 연산이 완료**된 것을 **트랜잭션 관리자에게 알려주는 연산**

#### 2. `Rollback` 연산

- 하나의 트랜잭션 처리가 **비정상적으로 종료**되어 데이터베이스의 일관성을 깨뜨렸을 때, 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성에 의해 **트랜잭션이 행한 모든 연산을 취소**(Undo)하는 연산
- Rollback시에는 해당 트랜잭션을 **재시작**하거나 **폐기**한다.

<br>

### 트랜잭션 상태

![](https://velog.velcdn.com/images/sukyeongs/post/6456a447-d680-4881-867f-542cda9f16be/image.png)

- **활동(Active)** : 트랜잭션이 실행중인 상태

- **실패(Failed)** : 트랜잭션 실행에 오류가 발생하여 중단된 상태

- **철회(Aborted)** : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태

- **부분 완료(Partially Committed)** : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태

- **완료(Committed)** : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태

<br>

---

<br>

## Reference

- <a href="https://gyoogle.dev/blog/computer-science/data-base/Transaction.html">신입 개발자 전공 지식 & 기술 면접 백과사전</a>
- <a href="https://coding-factory.tistory.com/226l">트랜잭션이란 무엇인가?</a>
- <a href="https://rebro.kr/163">병행제어란?</a>
